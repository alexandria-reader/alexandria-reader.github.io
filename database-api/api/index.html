<!doctype html><html lang=en class="js csstransforms3d">
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.92.0">
<meta name=generator content="Relearn 2.9.2
">
<meta name=description content="Design notes from development of the Alexandria language learning app.">
<meta name=author content="Team Alexandria">
<title>API Design :: Alexandria Case Study</title>
<link href=../../css/nucleus.css?1642072484 rel=stylesheet>
<link href=../../css/fontawesome-all.min.css?1642072484 rel=stylesheet>
<link href=../../css/featherlight.min.css?1642072484 rel=stylesheet>
<link href=../../css/perfect-scrollbar.min.css?1642072484 rel=stylesheet>
<link href=../../css/auto-complete.css?1642072484 rel=stylesheet>
<link href=../../css/theme.css?1642072484 rel=stylesheet>
<link href=../../css/theme-alexandria.css?1642072484 rel=stylesheet>
<link href=../../css/variant.css?1642072484 rel=stylesheet>
<link href=../../css/print.css?1642072484 rel=stylesheet media=print>
<script src=../../js/jquery.min.js?1642072484></script>
<style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code.copy-to-clipboard-inline+span.copy-to-clipboard{display:none}:not(pre)>code.copy-to-clipboard-inline{border-bottom-right-radius:2px;border-top-right-radius:2px;border-right-width:1px}</style>
</head>
<body data-url=../../database-api/api/>
<script>var index_url="../../index.json",root_url="../../",baseUri=root_url.replace(/\/$/,'')</script>
<nav id=sidebar>
<div id=header-wrapper>
<div id=header>
<a href=../../><img src=../../images/logo-light.png alt="Alexandria logo"></a>
</div>
<div class=searchbox>
<label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span>
</div>
<script src=../../js/lunr.min.js?1642072484></script>
<script src=../../js/auto-complete.js?1642072484></script>
<script src=../../js/search.js?1642072484></script>
</div>
<div id=homelinks>
<ul>
<li>
<a class=padding href=../../><i class="fas fa-home"></i> Home</a>
</li>
</ul>
</div>
<div class=highlightable>
<ul class=topics>
<li data-nav-id=/competitors/ title="Competitor Analysis" class=dd-item><a href=../../competitors/>Competitor Analysis</a><ul></ul></li>
<li data-nav-id=/decisions/ title="Technical Decisions" class="dd-item alwaysopen"><a href=../../decisions/>Technical Decisions</a><ul>
<li data-nav-id=/decisions/typescript/ title="Choosing TypeScript" class=dd-item><a href=../../decisions/typescript/>Choosing TypeScript</a></li>
<li data-nav-id=/decisions/sql/ title="SQL or NoSQL?" class=dd-item><a href=../../decisions/sql/>SQL or NoSQL?</a></li>
<li data-nav-id=/decisions/backend/ title="3 Layers for the Back End" class=dd-item><a href=../../decisions/backend/>3 Layers for the Back End</a></li>
<li data-nav-id=/decisions/react-recoil/ title="React and Recoil" class=dd-item><a href=../../decisions/react-recoil/>React and Recoil</a></li></ul></li>
<li data-nav-id=/database-api/ title="Database and API" class="dd-item parent alwaysopen"><a href=../../database-api/>Database and API</a><ul>
<li data-nav-id=/database-api/database/ title="Database Architecture" class=dd-item><a href=../../database-api/database/>Database Architecture</a></li>
<li data-nav-id=/database-api/api/ title="API Design" class="dd-item active"><a href=../../database-api/api/>API Design</a></li></ul></li>
<li data-nav-id=/challenges/ title="Challenges and Solutions" class="dd-item alwaysopen"><a href=../../challenges/>Challenges and Solutions</a><ul>
<li data-nav-id=/challenges/automated-tests/ title="Automating Tests" class=dd-item><a href=../../challenges/automated-tests/>Automating Tests</a></li>
<li data-nav-id=/challenges/text-parsing/ title="Text Parsing" class=dd-item><a href=../../challenges/text-parsing/>Text Parsing</a></li>
<li data-nav-id=/challenges/phrase-selection/ title="Phrase selection UI" class=dd-item><a href=../../challenges/phrase-selection/>Phrase selection UI</a></li></ul></li>
<li data-nav-id=/future/ title="MVP and Future Plans" class=dd-item><a href=../../future/>MVP and Future Plans</a><ul></ul></li>
<li data-nav-id=/references/ title=References class=dd-item><a href=../../references/>References</a><ul></ul></li>
</ul>
<div id=shortcuts>
<div class=nav-title>More</div>
<ul>
<li><a class=padding href=https://tryalexandria.com><i class="fas fa-fw fa-book"></i> Use the app, learn a language!</a></li>
<li><a class=padding href=https://github.com/alexandria-reader><i class="fab fa-fw fa-github"></i> Alexandria on GitHub</a></li>
</ul>
</div>
<div id=footer>
<p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p>
</div>
</div>
</nav>
<div id=body>
<div id=overlay></div>
<div class="padding highlightable">
<div id=top-bar>
<div id=breadcrumbs>
<span id=sidebar-toggle-span>
<a href=# id=sidebar-toggle data-sidebar-toggle>
<i class="fas fa-bars"></i>
</a>
</span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>
API Design
</span>
</div>
<div class=progress>
<div class=wrapper>
<nav id=TableOfContents>
<ul>
<li><a href=#resources-and-collections>Resources and collections</a></li>
<li><a href=#route-patterns>Route patterns</a>
<ul>
<li><a href=#basic-access>Basic access</a></li>
<li><a href=#filtering-collections>Filtering collections</a></li>
<li><a href=#special-routes>Special routes</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div id=head-tags>
</div>
<main id=body-inner>
<h1>API Design</h1>
<p>In the design of the API that is queried by the React front end, we aimed at following REST principles as outlined in Roy Fielding&rsquo;s 2000 dissertation
<sup><a href=../../references>[5]</a></sup>, but within the constraints of our type of application and of the current state of development.</p>
<ul>
<li><em>Client-Server</em>: As mentioned previously, this separation came naturally with the decision to create a React-based single page application.</li>
<li><em>Stateless</em>: For security reasons and device interchangeability, only the user id is stored with the client in a JSON Web token which is sent with every request. Additional information is always drawn from the user state which is kept in a Recoil atom. The request then includes the combined state information and sends it to the server.</li>
<li><em>Cacheable</em>: The core of Alexandria, the single text and translation page is a highly dynamic affair where cached responses for word and translation queries could seriously damage the user experience. We decided to only explicitly allow caching of responses for resources that do not change often: the list of languages, the web dictionary list, and the individual texts.</li>
<li><em>Layered System</em>: Front end and back end of Alexandria reside on different servers, allowing for independent scalability.</li>
<li><em>Code-on-Demand</em>: This was not actively implemented in Alexandria</li>
<li><em>Uniform Interface</em>: According to Fielding, &ldquo;In order to obtain a uniform interface, multiple architectural constraints are needed to guide the behavior of components: &mldr;
<ul>
<li>identification of resources,</li>
<li>manipulation of resources through representations,</li>
<li>self-descriptive messages,</li>
<li>hypermedia as the engine of application state.&rdquo;</li>
</ul>
</li>
</ul>
<p>During the API design we spend most of our time on getting the uniform interface right, or, more prosaically, come up with a system of URLs (routes) that - in combination with request bodies - would allow the client to get any response it requires from the server, and be logical and readable at the same time, to the API as accessible to new contributors as possible. Here is what we ended up with:</p>
<h2 id=resources-and-collections>Resources and collections</h2>
<ul>
<li><strong>Resources</strong> are the individual items (rows) of the main database tables (the once with a &ldquo;single noun&rdquo; name). Each resource has a unique id within its table.</li>
<li><strong>Collections</strong> are lists of resources, eg. words or texts, that can be filtered by criteria such as languages or user.</li>
</ul>
<h2 id=route-patterns>Route patterns</h2>
<h3 id=basic-access>Basic access</h3>
<ul>
<li>The type of the resource that is queried is always the first part of the route.</li>
<li>This is the case for both individual resources and collections.</li>
<li>The queried resource is named in plural form.</li>
<li>Individual resources are accessed by their id.</li>
<li>Data from other resources associated with the queried resource might be sent back as well, but querying those happens on the backend and is not exposed via the API.</li>
<li>Creation, updates and deletion of resources happens via the basic route, ie. without filters (see below).</li>
</ul>
<h4 id=examples>Examples</h4>
<ul>
<li><code>GET /texts/</code> => a collection of all texts</li>
<li><code>GET /texts/38422</code> => the text with id <code>38422</code></li>
<li><code>POST /translations</code> => create a new translation</li>
<li><code>PUT /users</code> => update user data</li>
<li><code>DELETE /texts/38422</code>=> removes text with id <code>22533</code></li>
</ul>
<h3 id=filtering-collections>Filtering collections</h3>
<ul>
<li>If the second part of the route is not an id, we are looking for a filtered collection of that resource.</li>
<li>Filters are indicated by a keyword (in singular) and a unique identifier.</li>
<li>Filters can be chained.</li>
<li>Filtering for the logged-in user is indicated via the URL. Filtering collections down to to those resources belonging to a user is done on the back end server based purely based on the functionality and access rights of the app.</li>
</ul>
<h4 id=examples-1>Examples</h4>
<ul>
<li><code>GET /words/text/17/language/fr</code> => get all words from text 17 that have a translation to French (unique identifier <code>fr</code>)</li>
<li><code>GET /texts/language/fr</code> => all texts in French (unique identifier <code>de</code>) belonging to the current user</li>
</ul>
<h3 id=special-routes>Special routes</h3>
<p>Certain functionality that the client demands from the server did not fit the resource schema outlined above, for example login or logout, or certain user related functions. In those cases, the route URLs deviate from the pattern after the initial resource and simply spell out what is expected of them.</p>
<footer class=footline>
</footer>
</main>
</div>
<div id=navigation>
<a class="nav nav-prev" href=../../database-api/database/ title="Database Architecture"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=../../challenges/ title="Challenges and Solutions"><i class="fa fa-chevron-right"></i></a>
</div>
</div>
<div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px>
<div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div>
</div>
<script src=../../js/clipboard.min.js?1642072484></script>
<script src=../../js/perfect-scrollbar.min.js?1642072484></script>
<script src=../../js/perfect-scrollbar.jquery.min.js?1642072484></script>
<script src=../../js/jquery.svg.pan.zoom.js?1642072484></script>
<script src=../../js/featherlight.min.js?1642072484></script>
<script src=../../js/modernizr.custom-3.6.0.js?1642072484></script>
<script src=../../js/mermaid.min.js?1642072484></script>
<script>typeof mermaid!='undefined'&&typeof mermaid.mermaidAPI!='undefined'&&mermaid.mermaidAPI.initialize(Object.assign({securityLevel:"antiscript"},JSON.parse('{ "startOnLoad": true }'),{startOnLoad:!1}))</script>
<script src=../../js/relearn.js?1642072484></script>
</body>
</html>