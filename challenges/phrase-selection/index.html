<!doctype html><html lang=en class="js csstransforms3d">
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.92.1">
<meta name=generator content="Relearn 2.9.2
">
<meta name=description content="Design notes from development of the Alexandria language learning app.">
<meta name=author content="Team Alexandria">
<title>Phrase selection UI :: Alexandria Case Study</title>
<link href=../../css/nucleus.css?1643710433 rel=stylesheet>
<link href=../../css/fontawesome-all.min.css?1643710433 rel=stylesheet>
<link href=../../css/featherlight.min.css?1643710433 rel=stylesheet>
<link href=../../css/perfect-scrollbar.min.css?1643710433 rel=stylesheet>
<link href=../../css/auto-complete.css?1643710433 rel=stylesheet>
<link href=../../css/theme.css?1643710433 rel=stylesheet>
<link href=../../css/theme-alexandria.css?1643710433 rel=stylesheet>
<link href=../../css/variant.css?1643710433 rel=stylesheet>
<link href=../../css/print.css?1643710433 rel=stylesheet media=print>
<script src=../../js/jquery.min.js?1643710433></script>
<style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code.copy-to-clipboard-inline+span.copy-to-clipboard{display:none}:not(pre)>code.copy-to-clipboard-inline{border-bottom-right-radius:2px;border-top-right-radius:2px;border-right-width:1px}</style>
</head>
<body data-url=../../challenges/phrase-selection/>
<script>var index_url="../../index.json",root_url="../../",baseUri=root_url.replace(/\/$/,'')</script>
<nav id=sidebar>
<div id=header-wrapper>
<div id=header>
<a href=../../><img src=../../images/logo-light.png alt="Alexandria logo"></a>
</div>
<div class=searchbox>
<label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span>
</div>
<script src=../../js/lunr.min.js?1643710433></script>
<script src=../../js/auto-complete.js?1643710433></script>
<script src=../../js/search.js?1643710433></script>
</div>
<div id=homelinks>
<ul>
<li>
<a class=padding href=../../><i class="fas fa-home"></i> Home</a>
</li>
</ul>
</div>
<div class=highlightable>
<ul class=topics>
<li data-nav-id=/competitors/ title="Competitor Analysis" class=dd-item><a href=../../competitors/>Competitor Analysis</a><ul></ul></li>
<li data-nav-id=/decisions/ title="Technical Decisions" class="dd-item alwaysopen"><a href=../../decisions/>Technical Decisions</a><ul>
<li data-nav-id=/decisions/typescript/ title="Choosing TypeScript" class=dd-item><a href=../../decisions/typescript/>Choosing TypeScript</a></li>
<li data-nav-id=/decisions/sql/ title="SQL or NoSQL?" class=dd-item><a href=../../decisions/sql/>SQL or NoSQL?</a></li>
<li data-nav-id=/decisions/backend/ title="3 Layers for the Back End" class=dd-item><a href=../../decisions/backend/>3 Layers for the Back End</a></li>
<li data-nav-id=/decisions/react-recoil/ title="React and Recoil" class=dd-item><a href=../../decisions/react-recoil/>React and Recoil</a></li></ul></li>
<li data-nav-id=/database-api/ title="Database and API" class="dd-item alwaysopen"><a href=../../database-api/>Database and API</a><ul>
<li data-nav-id=/database-api/database/ title="Database Architecture" class=dd-item><a href=../../database-api/database/>Database Architecture</a></li>
<li data-nav-id=/database-api/api/ title="API Design" class=dd-item><a href=../../database-api/api/>API Design</a></li></ul></li>
<li data-nav-id=/challenges/ title="Challenges and Solutions" class="dd-item parent alwaysopen"><a href=../../challenges/>Challenges and Solutions</a><ul>
<li data-nav-id=/challenges/automated-tests/ title="Automating Tests" class=dd-item><a href=../../challenges/automated-tests/>Automating Tests</a></li>
<li data-nav-id=/challenges/text-parsing/ title="Text Parsing" class=dd-item><a href=../../challenges/text-parsing/>Text Parsing</a></li>
<li data-nav-id=/challenges/phrase-selection/ title="Phrase selection UI" class="dd-item active"><a href=../../challenges/phrase-selection/>Phrase selection UI</a></li></ul></li>
<li data-nav-id=/future/ title="MVP and Future Plans" class=dd-item><a href=../../future/>MVP and Future Plans</a><ul></ul></li>
<li data-nav-id=/references/ title=References class=dd-item><a href=../../references/>References</a><ul></ul></li>
</ul>
<div id=shortcuts>
<div class=nav-title>More</div>
<ul>
<li><a class=padding href=https://tryalexandria.com><i class="fas fa-fw fa-book"></i> Use the app, learn a language!</a></li>
<li><a class=padding href=https://github.com/alexandria-reader><i class="fab fa-fw fa-github"></i> Alexandria on GitHub</a></li>
</ul>
</div>
<div id=footer>
<p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p>
</div>
</div>
</nav>
<div id=body>
<div id=overlay></div>
<div class="padding highlightable">
<div id=top-bar>
<div id=breadcrumbs>
<span id=sidebar-toggle-span>
<a href=# id=sidebar-toggle data-sidebar-toggle>
<i class="fas fa-bars"></i>
</a>
</span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>
Phrase selection UI
</span>
</div>
<div class=progress>
<div class=wrapper>
<nav id=TableOfContents></nav>
</div>
</div>
</div>
<div id=head-tags>
</div>
<main id=body-inner>
<h1>Phrase selection UI</h1>
<p>Alexandria&rsquo;s ability to allow users select and save phrases along with its translation is one of the key features that sets her apart from other open-source or commercial products on the market. This particular functionality was challenging to implement due to the way texts are displayed.</p>
<p>Each word in a user text resides within its own <code>span</code>. When user clicks on a word, it is set as the <code>currentWord</code> state, triggering a re-render of the translation input component, which contains the current word, existing translations, links to dictionaries and translations, as well as the option for user to set their level of familiarity with the word.</p>
<p>Phrases on the other hand, are components separate from words. They are also surrounded by highlighted <code>span</code>s based on a user&rsquo;s level of familiarity with the phrase. We needed a way to create phrases on the fly when a range of words was selected. Such range ought to be added to the <code>userWords</code> state, which would then automatically trigger the highlighting of the new phrase across the text.</p>
<p>First we had to settle on how to select a range of words, and debated two options:</p>
<ol>
<li>Selecting the text itself. This would bring the challenge of handling incomplete word selections. Consider, for example, the phrase &ldquo;<em>better the devil you know</em>&rdquo;. If a user started and/or ended their selection in the middle of a word, the <code>currentWord</code> might end up being displayed as &ldquo;<em>er the devil you kn</em>&rdquo; instead of the intended phrase. It was very important to us that this kind of &ldquo;sloppy&rdquo; selection was possible to enhance the user experience instead of forcing users to carefully point the cursor (or worse: their finger) at the exact start and end of the words.</li>
<li>Select the <code>span</code> elements containing the words. From a UI perspective we were drawn towards this approach because the <code>span</code> elements are the smallest units of our text, and we would not have the problem of incomplete words.</li>
</ol>
<p>But while we got a prototype of element selection working on desktop browsers, the problems on mobile browsers were unsurmountable within our given time frame. We turned towards developing a solution using text selection instead.</p>
<p>Using the browser API <code>Selection</code>, we were able to leverage <code>anchorNode</code> and <code>focusNode</code> to access where the selection started and ended. The next step was to determine whether the selection was forward (left to right) or backward (right to left), because this would influence how the selection had to be extended to complete words. This was done by spanning a new <code>Range</code> between <code>anchorNode</code> and <code>focusNode</code> and checking whether it was <code>collapsed</code> (meaning the selection was backwards). The selection would be extended in the appropriate directions using the <code>setBaseAndExtend</code> method.</p>
<p>Finally, the <code>textContent</code> of the Nodes within the selection was extracted and set as the new phrase to be added to the <code>UserWords</code> state.</p>
<footer class=footline>
</footer>
</main>
</div>
<div id=navigation>
<a class="nav nav-prev" href=../../challenges/text-parsing/ title="Text Parsing"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=../../future/ title="MVP and Future Plans"><i class="fa fa-chevron-right"></i></a>
</div>
</div>
<div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px>
<div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div>
</div>
<script src=../../js/clipboard.min.js?1643710433></script>
<script src=../../js/perfect-scrollbar.min.js?1643710433></script>
<script src=../../js/perfect-scrollbar.jquery.min.js?1643710433></script>
<script src=../../js/jquery.svg.pan.zoom.js?1643710433></script>
<script src=../../js/featherlight.min.js?1643710433></script>
<script src=../../js/modernizr.custom-3.6.0.js?1643710433></script>
<script src=../../js/mermaid.min.js?1643710433></script>
<script>typeof mermaid!='undefined'&&typeof mermaid.mermaidAPI!='undefined'&&mermaid.mermaidAPI.initialize(Object.assign({securityLevel:"antiscript"},JSON.parse('{ "startOnLoad": true }'),{startOnLoad:!1}))</script>
<script src=../../js/relearn.js?1643710433></script>
</body>
</html>